# ğŸ“ˆ Aè‚¡æ™ºèƒ½äº¤æ˜“åˆ†æç³»ç»Ÿ

åŸºäº FastAPI + React çš„ç°ä»£åŒ–Aè‚¡åˆ†æç³»ç»Ÿï¼Œæä¾› K çº¿å›¾è¡¨ã€æŠ€æœ¯æŒ‡æ ‡åˆ†æå’Œäº¤æ˜“ä¿¡å·ã€‚

## ğŸŒŸ åŠŸèƒ½ç‰¹æ€§

- **å®æ—¶è¡Œæƒ…**: Aè‚¡/æ¸¯è‚¡å®æ—¶è¡Œæƒ…ï¼Œæ”¯æŒæ–°æµª/è…¾è®¯/ä¸œæ–¹è´¢å¯Œå¤šæ•°æ®æºå®¹ç¾
- **åˆ†æ—¶èµ°åŠ¿**: å½“æ—¥åˆ†é’Ÿçº§èµ°åŠ¿å›¾ï¼Œå‡ä»·çº¿
- **æ¸¯è‚¡æ•°æ®**: æ¸¯è‚¡å®æ—¶è¡Œæƒ… + å†å²Kçº¿ï¼ˆå‰å¤æƒï¼‰
- **å¤–æ±‡ç‰Œä»·**: ä¸­å›½é“¶è¡Œå®æ—¶å¤–æ±‡ç‰Œä»·
- **è‡ªé€‰è‚¡ç®¡ç†**: åˆ†ç»„ç®¡ç†è‚¡ç¥¨ï¼Œå®æ—¶æ˜¾ç¤ºæ¶¨è·Œ
- **æŠ€æœ¯æŒ‡æ ‡**: MAå‡çº¿ã€KDJã€MACDã€BBIã€çŸ¥è¡Œè¶‹åŠ¿
- **æ™ºèƒ½ä¿¡å·**: è‡ªåŠ¨ç”Ÿæˆé‡‘å‰/æ­»å‰äº¤æ˜“ä¿¡å·
- **Kçº¿å›¾è¡¨**: TradingView é£æ ¼ä¸“ä¸šå›¾è¡¨
- **æ™ºèƒ½ç¼“å­˜**: SQLite æœ¬åœ°å­˜å‚¨ + å†…å­˜ç¼“å­˜ï¼Œå‡å°‘æ¥å£è®¿é—®

## ğŸ›  æŠ€æœ¯æ ˆ

| åç«¯ | å‰ç«¯ | æ•°æ®æº |
|------|------|--------|
| Python 3.10+, FastAPI | React 18, TypeScript | AKShare, æ–°æµª/è…¾è®¯/ä¸œæ–¹è´¢å¯Œ |
| Pandas, NumPy, SQLite | Lightweight Charts | ä¸­å›½é“¶è¡Œæ±‡ç‡ |

## ğŸ“ é¡¹ç›®æ¶æ„

```
Stock/
â”œâ”€â”€ api/                    # API å±‚
â”‚   â”œâ”€â”€ main.py             # ä¸»å…¥å£ (95è¡Œ)
â”‚   â”œâ”€â”€ routes/             # æ¨¡å—åŒ–è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ stock.py        # è‚¡ç¥¨åˆ†æ
â”‚   â”‚   â”œâ”€â”€ market.py       # å¸‚åœºæ•°æ®
â”‚   â”‚   â”œâ”€â”€ realtime.py     # å®æ—¶è¡Œæƒ…
â”‚   â”‚   â”œâ”€â”€ hk.py           # æ¸¯è‚¡è¡Œæƒ…
â”‚   â”‚   â””â”€â”€ user.py         # ç”¨æˆ·ç®¡ç†
â”‚   â””â”€â”€ validators.py       # éªŒè¯å™¨
â”œâ”€â”€ services/               # æœåŠ¡å±‚
â”‚   â”œâ”€â”€ realtime_quotation_service.py  # å®æ—¶è¡Œæƒ… (å¤šæ•°æ®æºå®¹ç¾)
â”‚   â”œâ”€â”€ local_data_service.py          # æœ¬åœ°å­˜å‚¨ + æ™ºèƒ½è·å–
â”‚   â”œâ”€â”€ realtime_kline_service.py      # Kçº¿èåˆ
â”‚   â”œâ”€â”€ hk_quotation_service.py        # æ¸¯è‚¡è¡Œæƒ…
â”‚   â”œâ”€â”€ data_config.py                 # ç»Ÿä¸€é…ç½®
â”‚   â””â”€â”€ fallback.py                    # å®¹ç¾æ‰§è¡Œå™¨
â”œâ”€â”€ analyzers/              # åˆ†æå™¨
â”‚   â”œâ”€â”€ stock_analyzer.py   # è‚¡ç¥¨åˆ†æå¼•æ“
â”‚   â”œâ”€â”€ indicators.py       # æŠ€æœ¯æŒ‡æ ‡
â”‚   â””â”€â”€ data_fetcher.py     # æ•°æ®è·å–ä»£ç†
â”œâ”€â”€ utils/                  # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ logger.py           # æ—¥å¿—
â”‚   â”œâ”€â”€ stock_utils.py      # è‚¡ç¥¨ä»£ç å·¥å…·
â”‚   â””â”€â”€ date_utils.py       # æ—¥æœŸæ—¶é—´å·¥å…·
â”œâ”€â”€ frontend/               # React å‰ç«¯
â”œâ”€â”€ tests/                  # å•å…ƒæµ‹è¯•
â”œâ”€â”€ data/                   # æ•°æ®ç›®å½• (SQLite)
â””â”€â”€ settings.py             # å…¨å±€é…ç½®
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æœ¬åœ°å¼€å‘

```bash
# åç«¯
cd Stock
python -m venv .venv && source .venv/bin/activate
pip install -r requirements.txt
uvicorn api.main:app --reload --host 0.0.0.0 --port 8000

# å‰ç«¯
cd frontend
npm install && npm run dev
```

### Docker éƒ¨ç½²

```bash
docker-compose up -d --build
```

## ğŸ“¡ API ç«¯ç‚¹

### è‚¡ç¥¨åˆ†æ
| æ–¹æ³• | ç«¯ç‚¹ | è¯´æ˜ |
|------|------|------|
| GET | `/api/stock/{code}` | åˆ†æå•åªè‚¡ç¥¨ |
| GET | `/api/stock/{code}/full` | åˆ†æ + Kçº¿å†å² |
| POST | `/api/stock/batch` | æ‰¹é‡åˆ†æ |
| GET | `/api/stocks/search?q=xxx` | æœç´¢è‚¡ç¥¨ |

### å®æ—¶è¡Œæƒ…
| æ–¹æ³• | ç«¯ç‚¹ | è¯´æ˜ |
|------|------|------|
| GET | `/api/realtime/{code}` | å•åªè‚¡ç¥¨å®æ—¶è¡Œæƒ… |
| POST | `/api/realtime/batch` | æ‰¹é‡è¡Œæƒ… (æœ€å¤š50åª) |
| GET | `/api/realtime/market?limit=50` | å…¨å¸‚åœºå¿«ç…§ |
| GET | `/api/stock/{code}/intraday` | åˆ†æ—¶èµ°åŠ¿æ•°æ® |
| GET | `/api/stock/{code}/kline-realtime` | å†å²+å®æ—¶Kçº¿ |

### å¸‚åœºæ•°æ®
| æ–¹æ³• | ç«¯ç‚¹ | è¯´æ˜ |
|------|------|------|
| GET | `/api/market/ticker` | å¸‚åœºæŒ‡æ•°è¡Œæƒ… |
| GET | `/api/market/indices` | å¸‚åœºæŒ‡æ•°åˆ—è¡¨ |
| GET | `/api/market/sectors` | çƒ­é—¨è¡Œä¸šæ¿å— |
| GET | `/api/index/{code}/history` | æŒ‡æ•°å†å²æ•°æ® |

### æ¸¯è‚¡è¡Œæƒ…
| æ–¹æ³• | ç«¯ç‚¹ | è¯´æ˜ |
|------|------|------|
| GET | `/api/hk/realtime/{code}` | å•åªæ¸¯è‚¡è¡Œæƒ… |
| POST | `/api/hk/realtime/batch` | æ‰¹é‡æ¸¯è‚¡ (æœ€å¤š30åª) |
| GET | `/api/hk/detail/{code}` | æ¸¯è‚¡è¯¦ç»†ä¿¡æ¯ |
| GET | `/api/hk/kline/{code}?days=90` | æ¸¯è‚¡Kçº¿ |

### ç”¨æˆ·ç®¡ç†
| æ–¹æ³• | ç«¯ç‚¹ | è¯´æ˜ |
|------|------|------|
| GET | `/api/user/stocks` | è·å–è‡ªé€‰è‚¡åˆ†ç»„ |
| POST | `/api/user/stocks` | æ·»åŠ è‡ªé€‰è‚¡ |
| DELETE | `/api/user/stocks` | åˆ é™¤è‡ªé€‰è‚¡ |
| GET | `/api/exchange/usd` | ç¾å…ƒæ±‡ç‡ |
| GET | `/api/exchange/all` | æ‰€æœ‰æ±‡ç‡ |

## ğŸ”§ æ•°æ®è·å–å®¹ç¾é“¾

```
å®æ—¶è¡Œæƒ…: æ–°æµª â†’ è…¾è®¯ â†’ ä¸œæ–¹è´¢å¯Œ
åˆ†æ—¶æ•°æ®: ä¸œæ–¹è´¢å¯Œ â†’ è…¾è®¯
å†å²Kçº¿: SQLiteæœ¬åœ° â†’ AkShare â†’ Tushare
```

## âš™ï¸ ç¯å¢ƒå˜é‡

| å˜é‡ | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| `CORS_ORIGINS` | å…è®¸çš„å‰ç«¯åŸŸå | `http://localhost:5173` |
| `LOG_LEVEL` | æ—¥å¿—çº§åˆ« | `INFO` |
| `MEMORY_CACHE_TTL` | å†…å­˜ç¼“å­˜æ—¶é—´(ç§’) | `300` |
| `REQUEST_TIMEOUT` | è¯·æ±‚è¶…æ—¶(ç§’) | `15` |
| `MAX_RETRIES` | æœ€å¤§é‡è¯•æ¬¡æ•° | `3` |

## ğŸ§ª æµ‹è¯•

```bash
pip install pytest
pytest tests/ -v
```

## ğŸ“ æ³¨æ„äº‹é¡¹

- è‚¡ç¥¨ä»£ç ä¸º 6 ä½æ•°å­— (å¦‚ `000001`, `600519`)
- æ¸¯è‚¡ä»£ç ä¸º 4-5 ä½æ•°å­— (å¦‚ `00700`, `9988`)
- æ•°æ®ä¾èµ–ç½‘ç»œæ¥å£ï¼Œè¯·ä¿æŒç½‘ç»œè¿æ¥
- Kçº¿æ•°æ®è‡ªåŠ¨ç¼“å­˜åˆ° SQLiteï¼Œå‡å°‘æ¥å£è°ƒç”¨

## ğŸ“„ License

MIT
